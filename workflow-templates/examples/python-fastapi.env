# ============================================================================
# Python FastAPI - Configuration Example
# ============================================================================
# Configuration for Python FastAPI backend applications with PostgreSQL/Redis
# ============================================================================

# ----------------------------------------------------------------------------
# REPOSITORY INFORMATION
# ----------------------------------------------------------------------------
REPO_OWNER="your-github-username"
REPO_NAME="fastapi-backend"
MAIN_BRANCH="main"
DEV_BRANCH="development"
PROD_BRANCH="production"

# ----------------------------------------------------------------------------
# PROJECT CONFIGURATION
# ----------------------------------------------------------------------------
PROJECT_TYPE="python-api"
PRIMARY_LANGUAGE="python"
PACKAGE_MANAGER="poetry"

# Python version
PYTHON_VERSION="3.11"

# ----------------------------------------------------------------------------
# BUILD & TEST COMMANDS
# ----------------------------------------------------------------------------
# Poetry commands
INSTALL_CMD="poetry install"
BUILD_CMD="poetry build"
TEST_CMD="poetry run pytest"
LINT_CMD="poetry run black . && poetry run flake8 && poetry run mypy ."
TYPE_CHECK_CMD="poetry run mypy ."

# Alternative for pip/requirements.txt
# INSTALL_CMD="pip install -r requirements.txt"
# TEST_CMD="pytest"
# LINT_CMD="black . && flake8 && mypy ."

# ----------------------------------------------------------------------------
# PYTHON SPECIFIC SETTINGS
# ----------------------------------------------------------------------------
# Code formatting
USE_BLACK=true
BLACK_LINE_LENGTH=88

# Linting
USE_FLAKE8=true
FLAKE8_MAX_LINE_LENGTH=88
USE_PYLINT=true

# Type checking
USE_MYPY=true
MYPY_STRICT=true

# Import sorting
USE_ISORT=true
ISORT_PROFILE="black"

# Security scanning
USE_BANDIT=true
USE_SAFETY=true

# ----------------------------------------------------------------------------
# TESTING CONFIGURATION
# ----------------------------------------------------------------------------
# Pytest settings
PYTEST_COVERAGE_THRESHOLD=85
PYTEST_MARKERS="unit,integration,e2e"
PYTEST_PARALLEL=true
PYTEST_WORKERS=4

# Test database
TEST_DATABASE_URL="postgresql://test:test@localhost:5432/test_db"
TEST_REDIS_URL="redis://localhost:6379/1"

# ----------------------------------------------------------------------------
# BRANCH PROTECTION SETTINGS
# ----------------------------------------------------------------------------
PROD_REQUIRE_REVIEWS=true
PROD_REQUIRED_APPROVALS=2
PROD_REQUIRE_SIGNED_COMMITS=true
PROD_REQUIRE_STATUS_CHECKS=true
PROD_REQUIRED_CHECKS="test,lint,mypy,security-scan,docker-build"

MAIN_REQUIRE_REVIEWS=true
MAIN_REQUIRED_APPROVALS=1
MAIN_REQUIRE_STATUS_CHECKS=true
MAIN_REQUIRED_CHECKS="test,lint,mypy"

DEV_REQUIRE_STATUS_CHECKS=true
DEV_REQUIRED_CHECKS="test,lint"

# ----------------------------------------------------------------------------
# SECURITY SETTINGS
# ----------------------------------------------------------------------------
ENABLE_DEPENDABOT=true
ENABLE_CODEQL=true
ENABLE_SECRET_SCANNING=true
REQUIRE_CODEOWNERS=true
CODEOWNERS_PATH=".github/CODEOWNERS"

# Python security tools
RUN_BANDIT=true
RUN_SAFETY=true
RUN_PIP_AUDIT=true

# ----------------------------------------------------------------------------
# CI/CD PROVIDER
# ----------------------------------------------------------------------------
CI_PROVIDER="github-actions"
ENABLE_AUTO_DEPLOY=true

# ----------------------------------------------------------------------------
# DEPLOYMENT SETTINGS
# ----------------------------------------------------------------------------
# Development environment
DEV_DEPLOY_URL="https://api-dev.example.com"
DEV_DATABASE_URL="postgresql://user:pass@dev-db.example.com:5432/app_dev"
DEV_REDIS_URL="redis://dev-redis.example.com:6379/0"

# Staging environment
STAGING_DEPLOY_URL="https://api-staging.example.com"
STAGING_DATABASE_URL="postgresql://user:pass@staging-db.example.com:5432/app_staging"
STAGING_REDIS_URL="redis://staging-redis.example.com:6379/0"

# Production environment
PROD_DEPLOY_URL="https://api.example.com"
PROD_DATABASE_URL="postgresql://user:pass@prod-db.example.com:5432/app_prod"
PROD_REDIS_URL="redis://prod-redis.example.com:6379/0"

# Deployment platform
DEPLOY_PLATFORM="docker"

# Auto-deploy settings
AUTO_DEPLOY_DEV=true
AUTO_DEPLOY_STAGING=true
PROD_MANUAL_APPROVAL=true

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------
# PostgreSQL
DATABASE_ENGINE="postgresql"
DATABASE_HOST="localhost"
DATABASE_PORT=5432
DATABASE_NAME="app_db"
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# Database migrations
USE_ALEMBIC=true
ALEMBIC_AUTO_GENERATE=true
RUN_MIGRATIONS_ON_DEPLOY=true

# ----------------------------------------------------------------------------
# REDIS CONFIGURATION
# ----------------------------------------------------------------------------
# Redis for caching and background tasks
REDIS_HOST="localhost"
REDIS_PORT=6379
REDIS_DB=0
REDIS_MAX_CONNECTIONS=50

# Cache settings
CACHE_TTL=3600
CACHE_KEY_PREFIX="app:"

# ----------------------------------------------------------------------------
# API CONFIGURATION
# ----------------------------------------------------------------------------
# FastAPI settings
API_TITLE="FastAPI Backend"
API_VERSION="1.0.0"
API_PREFIX="/api/v1"

# CORS settings
CORS_ORIGINS="https://app.example.com,https://www.example.com"
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS="GET,POST,PUT,DELETE,PATCH"
CORS_ALLOW_HEADERS="*"

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# ----------------------------------------------------------------------------
# DOCKER SETTINGS
# ----------------------------------------------------------------------------
DOCKER_REGISTRY="ghcr"
DOCKER_IMAGE_NAME="${REPO_OWNER}/${REPO_NAME}"
DOCKER_BASE_IMAGE="python:3.11-slim"

# Docker Compose
DOCKER_COMPOSE_FILE="docker-compose.yml"
DOCKER_COMPOSE_PROD_FILE="docker-compose.prod.yml"

# Multi-stage build
DOCKER_USE_MULTI_STAGE=true
DOCKER_BUILD_TARGET="production"

# ----------------------------------------------------------------------------
# BACKGROUND TASKS & WORKERS
# ----------------------------------------------------------------------------
# Celery configuration
USE_CELERY=true
CELERY_BROKER_URL="${REDIS_URL}"
CELERY_RESULT_BACKEND="${REDIS_URL}"
CELERY_WORKER_COUNT=4

# Task queue
TASK_QUEUE_NAME="default"
TASK_RETRY_LIMIT=3
TASK_RETRY_BACKOFF=true

# ----------------------------------------------------------------------------
# LOGGING & MONITORING
# ----------------------------------------------------------------------------
# Logging
LOG_LEVEL="INFO"
LOG_FORMAT="json"
LOG_FILE="/var/log/app/app.log"

# Sentry integration
SENTRY_DSN="https://xxxxx@sentry.io/xxxxx"
SENTRY_ENVIRONMENT="production"
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus metrics
ENABLE_PROMETHEUS=true
PROMETHEUS_PORT=9090

# Health checks
HEALTH_CHECK_ENDPOINT="/health"
READINESS_CHECK_ENDPOINT="/ready"

# ----------------------------------------------------------------------------
# AUTHENTICATION & AUTHORIZATION
# ----------------------------------------------------------------------------
# JWT settings
JWT_SECRET_KEY="your-secret-key-here"
JWT_ALGORITHM="HS256"
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# OAuth providers
ENABLE_OAUTH=true
GOOGLE_CLIENT_ID=""
GITHUB_CLIENT_ID=""

# ----------------------------------------------------------------------------
# NOTIFICATION SETTINGS
# ----------------------------------------------------------------------------
SLACK_WEBHOOK_URL="https://hooks.slack.com/services/YOUR/WEBHOOK/URL"
DISCORD_WEBHOOK_URL=""
NOTIFICATION_EMAIL="backend-team@example.com"

# Alert thresholds
ALERT_ON_ERROR_RATE_ABOVE=5
ALERT_ON_RESPONSE_TIME_ABOVE=1000
ALERT_ON_CPU_USAGE_ABOVE=80

# ----------------------------------------------------------------------------
# DOCUMENTATION
# ----------------------------------------------------------------------------
# OpenAPI/Swagger
OPENAPI_URL="/openapi.json"
SWAGGER_UI_URL="/docs"
REDOC_URL="/redoc"

# Auto-generate API docs
AUTO_GENERATE_DOCS=true
INCLUDE_SCHEMAS_IN_DOCS=true

# ----------------------------------------------------------------------------
# ADDITIONAL SETTINGS
# ----------------------------------------------------------------------------
REQUIRE_LINEAR_HISTORY=false
ALLOW_SQUASH_MERGE=true
ALLOW_MERGE_COMMIT=true
ALLOW_REBASE_MERGE=true
DELETE_BRANCH_ON_MERGE=true

# ----------------------------------------------------------------------------
# PERFORMANCE OPTIMIZATION
# ----------------------------------------------------------------------------
# Database query optimization
ENABLE_QUERY_LOGGING=true
SLOW_QUERY_THRESHOLD=1000

# Caching strategy
CACHE_STRATEGY="redis"
CACHE_SERIALIZER="json"

# Connection pooling
USE_CONNECTION_POOLING=true
POOL_SIZE=20
MAX_OVERFLOW=10

# ----------------------------------------------------------------------------
# AI REFACTORING SETTINGS
# ----------------------------------------------------------------------------
AI_PROVIDER="claude"
AI_MODEL="claude-3-sonnet"
AI_MAX_TOKENS=4000
AI_TEMPERATURE=0.2
